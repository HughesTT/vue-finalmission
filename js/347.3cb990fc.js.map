{"version":3,"file":"js/347.3cb990fc.js","mappings":"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","sources":["webpack://project_a/./src/views/backstage/CouponPage.vue","webpack://project_a/./src/components/backstage/CouponModal.vue","webpack://project_a/./src/components/backstage/CouponModal.vue?d765","webpack://project_a/./src/views/backstage/CouponPage.vue?4c9e"],"sourcesContent":["<template>\r\n  <LoadingElement :active=\"isLoading\"></LoadingElement>\r\n  <div class=\"container mt-4\">\r\n    <button class=\"btn  btn-purple\" @click.prevent=\"openCouponModal(true)\">\r\n      建立優惠券\r\n    </button>\r\n    <table class=\"table mt-4\">\r\n      <thead>\r\n        <tr>\r\n          <th>名稱</th>\r\n          <th>折扣</th>\r\n          <th>使用期限</th>\r\n          <th>是否啟用</th>\r\n          <th>編輯</th>\r\n        </tr>\r\n      </thead>\r\n      <tbody>\r\n        <tr v-for=\"(item, key) in coupons\" :key=\"key\">\r\n          <td>{{ item.title }}</td>\r\n          <td>{{ item.percent }}</td>\r\n          <td>{{ item.due_date }}</td>\r\n          <td>\r\n            <span v-if=\"item.is_enabled === 1\">啟用</span>\r\n            <span v-else>未啟用</span>\r\n          </td>\r\n          <td>\r\n            <div class=\"btn-group\">\r\n              <button class=\"btn btn-outline-primary btn-sm\" @click.prevent=\"openCouponModal(false, item)\">編輯</button>\r\n              <button class=\"btn btn-outline-danger btn-sm\" @click=\"openDelCouponModal(item)\">刪除</button>\r\n            </div>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n    <CouponModal :coupon=\"tempCoupon\" ref=\"couponModal\" @update-coupon=\"updateCoupon\">\r\n    </CouponModal>\r\n    <DelModal :item=\"tempCoupon\" ref=\"delModal\" @del-item=\"delCoupon\" />\r\n  </div>\r\n</template>\r\n\r\n<style></style>\r\n\r\n<script>\r\nimport CouponModal from '@/components/backstage/CouponModal.vue';\r\nimport DelModal from '@/components/backstage/DelModal.vue';\r\n\r\nexport default {\r\n  components: {\r\n    CouponModal,\r\n    DelModal,\r\n  },\r\n  props: {\r\n    config: Object,\r\n  },\r\n  data() {\r\n    return {\r\n      coupons: {}, // 優惠券\r\n      tempCoupon: { // 新增或編輯優惠券暫時儲存的位址\r\n        title: '', // 優惠券名稱\r\n        is_enabled: 0, // 是否啟用\r\n        percent: 100, // 折扣百分比\r\n        code: '', // 折扣碼\r\n      },\r\n      isNew: false, // 判別是否為新增或編輯，預設false\r\n      isLoading: false, // 資料讀取的動態效果\r\n    };\r\n  },\r\n  methods: {\r\n    openCouponModal(isNew, item) {\r\n      this.isNew = isNew;\r\n      if (this.isNew) {\r\n        this.tempCoupon = {\r\n          due_date: new Date().getTime() / 1000,\r\n        }; // 若為新增，modal欄位為空白，日期欄位為當下日期\r\n      } else {\r\n        this.tempCoupon = { ...item }; // 若為編輯，將item資料帶入欄位\r\n      }\r\n      this.$refs.couponModal.showModal();\r\n    },\r\n    openDelCouponModal(item) {\r\n      this.tempCoupon = { ...item };\r\n      const delComponent = this.$refs.delModal;\r\n      delComponent.showModal();\r\n    },\r\n    getCoupons() {\r\n      this.isLoading = true;\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupons`;\r\n      this.$http.get(url, this.tempProduct).then((res) => {\r\n        this.coupons = res.data.coupons;\r\n        this.isLoading = false;\r\n      });\r\n    },\r\n    updateCoupon(tempCoupon) {\r\n      // 如優惠券為新增\r\n      this.isLoading = true;\r\n      if (this.isNew) {\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon`;\r\n        this.$http.post(url, { data: tempCoupon }).then((res) => {\r\n          this.$httpMessageState(res, '新增優惠券成功'); // 顯示推播\r\n          this.getCoupons(); // 重新讀取優惠券\r\n          this.$refs.couponModal.hideModal(); // 將modal關閉\r\n        });\r\n      } else {\r\n        const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\r\n        this.$http.put(url, { data: this.tempCoupon }).then((res) => {\r\n          this.$httpMessageState(res, '更新優惠券成功');\r\n          this.$refs.couponModal.hideModal();\r\n          this.getCoupons();\r\n          this.isLoading = false;\r\n        });\r\n      }\r\n    },\r\n    delCoupon() {\r\n      const url = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\r\n      this.isLoading = true;\r\n      this.$http.delete(url).then((res) => {\r\n        this.$httpMessageState(res, '成功刪除優惠券');\r\n        const delComponent = this.$refs.delModal;\r\n        delComponent.hideModal();\r\n        this.getCoupons();\r\n      });\r\n    },\r\n  },\r\n  created() {\r\n    this.getCoupons();\r\n  },\r\n};\r\n</script>\r\n","<template>\r\n  <div class=\"modal fade\" id=\"couponModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"exampleModalLabel\"\r\n    aria-hidden=\"true\" ref=\"modal\">\r\n    <div class=\"modal-dialog\" role=\"document\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header\">\r\n          <h5 class=\"modal-title\" id=\"exampleModalLabel\">新增 / 編輯優惠券</h5>\r\n          <button class=\"btn-close\" type=\"button\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"modal-body\">\r\n          <div class=\"mb-3\">\r\n            <label for=\"title\">\r\n              標題\r\n              <input type=\"text\" class=\"col-12 form-control\" id=\"title\" placeholder=\"請輸入標題\" v-model=\"tempCoupon.title\">\r\n            </label>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"coupon\">\r\n              優惠碼\r\n              <input type=\"text\" class=\"form-control\" id=\"coupon_code\" placeholder=\"請輸入優惠碼\" v-model=\"tempCoupon.code\">\r\n            </label>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"due_date\">\r\n              使用期限\r\n              <input type=\"date\" class=\"form-control\" id=\"due_date\" v-model=\"due_date\"></label>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <label for=\"price\">\r\n              折扣百分比\r\n              <input type=\"number\" class=\"form-control\" id=\"price\" v-model=\"tempCoupon.percent\" placeholder=\"請輸入折扣百分比\">\r\n            </label>\r\n          </div>\r\n          <div class=\"mb-3\">\r\n            <div class=\"form-check\">\r\n              <label for=\"is_enabled\" class=\"form-check-label\">\r\n                是否啟用\r\n                <input type=\"checkbox\" class=\"form-check-input\" :true-value=\"1\" :false-value=\"0\"\r\n                  v-model=\"tempCoupon.is_enabled\">\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer\">\r\n          <button class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Close</button>\r\n          <button class=\"btn btn-primary\" @click=\"$emit('update-coupon', tempCoupon)\">更新優惠券</button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<style></style>\r\n\r\n<script>\r\nimport modalMixin from '@/mixins/modalMixin';\r\n\r\nexport default {\r\n  name: 'ccouponModal',\r\n  props: {\r\n    coupon: {},\r\n  },\r\n  data() {\r\n    return {\r\n      tempCoupon: {}, // 接收外層傳來帶入的資料\r\n      due_date: '', // 到期日\r\n    };\r\n  },\r\n  emits: ['update-coupon'],\r\n  watch: {\r\n    coupon() {\r\n      this.tempCoupon = this.coupon;\r\n      const dateAndTime = new Date(this.tempCoupon.due_date * 1000).toISOString().split('T'); // toISOString時間格式轉換，split將原字串分割成子字串，再回傳\r\n      [this.due_date] = dateAndTime;\r\n    },\r\n    due_date() {\r\n      this.tempCoupon.due_date = Math.floor(new Date(this.due_date) / 1000); // 無條件捨去，回傳「小於等於」所給數字的最大整數\r\n    },\r\n  },\r\n  mixins: [modalMixin],\r\n};\r\n</script>\r\n","import { render } from \"./CouponModal.vue?vue&type=template&id=e27ed510\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./CouponPage.vue?vue&type=template&id=52955930\"\nimport script from \"./CouponPage.vue?vue&type=script&lang=js\"\nexport * from \"./CouponPage.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","key","_createElementBlock","_Fragment","_createVNode","_component_LoadingElement","active","$data","isLoading","_createElementVNode","_hoisted_1","onClick","_cache","_withModifiers","$event","$options","openCouponModal","_hoisted_2","_renderList","coupons","item","_toDisplayString","title","percent","due_date","is_enabled","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","openDelCouponModal","_hoisted_7","_component_CouponModal","coupon","tempCoupon","ref","onUpdateCoupon","updateCoupon","_component_DelModal","onDelItem","delCoupon","id","tabindex","role","for","type","_createTextVNode","placeholder","_hoisted_8","code","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_ctx","$emit","name","props","data","emits","watch","this","dateAndTime","Date","toISOString","split","Math","floor","mixins","modalMixin","__exports__","components","CouponModal","DelModal","config","Object","isNew","methods","getTime","$refs","couponModal","showModal","delComponent","delModal","getCoupons","url","$http","get","tempProduct","then","res","post","$httpMessageState","hideModal","put","delete","created","render"],"sourceRoot":""}