"use strict";(self["webpackChunkproject_a"]=self["webpackChunkproject_a"]||[]).push([[751],{1265:function(e,t,a){a.d(t,{A:function(){return h}});var l=a(6768),r=a(4232),s=a(5130);const d={"aria-label":"Page navigation example"},n={class:"pagination justify-content-center"},i=["onClick"];function o(e,t,a,o,u,p){return(0,l.uX)(),(0,l.CE)("nav",d,[(0,l.Lk)("ul",n,[(0,l.Lk)("li",{class:(0,r.C4)(["page-item",{disabled:a.pages.has_pre<1}])},[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,s.D$)((e=>p.updatePage(1)),["prevent"]))},t[2]||(t[2]=[(0,l.Lk)("span",{"aria-hidden":"true"},"«",-1)]))],2),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.pages.total_pages,(e=>((0,l.uX)(),(0,l.CE)("li",{class:(0,r.C4)(["page-item",{active:e===a.pages.current_page}]),key:e},[(0,l.Lk)("a",{class:"page-link",href:"#",onClick:(0,s.D$)((t=>p.updatePage(e)),["prevent"])},(0,r.v_)(e),9,i)],2)))),128)),(0,l.Lk)("li",{class:(0,r.C4)(["page-item",{disabled:a.pages.has_next<1}])},[(0,l.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,s.D$)(((...e)=>p.endPage&&p.endPage(...e)),["prevent"]))},t[3]||(t[3]=[(0,l.Lk)("span",{"aria-hidden":"true"},"»",-1)]))],2)])])}var u={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)},nextPage(){!0===this.pages.has_next&&this.$emit("emit-pages",this.pages.current_page+1)},prePage(){!0===this.pages.has_pre&&this.$emit("emit-pages",this.pages.current_page-1)},endPage(){this.pages.total_pages&&this.$emit("emit-pages",this.pages.total_pages)}}},p=a(1241);const c=(0,p.A)(u,[["render",o]]);var h=c},9751:function(e,t,a){a.r(t),a.d(t,{default:function(){return q}});var l=a(6768),r=a(4232),s=a(5130);const d={class:"container"},n={class:"table mt-4"},i={class:"list-unstyle"},o={class:"form-check form-switch"},u=["for"],p=["id","onUpdate:modelValue","onChange"],c={key:0},h={key:1},k=["onClick"],L=["onClick"];function m(e,t,a,m,g,b){const v=(0,l.g2)("LoadingElement"),_=(0,l.g2)("Pagination"),f=(0,l.g2)("DelModal"),O=(0,l.g2)("OrderModal");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(v,{active:g.isLoading},null,8,["active"]),(0,l.Lk)("div",d,[(0,l.Lk)("table",n,[t[1]||(t[1]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",null,"購買時間"),(0,l.Lk)("th",null,"Email"),(0,l.Lk)("th",null,"商品 / 數量"),(0,l.Lk)("th",null,"購買金額"),(0,l.Lk)("th",null,"是否付款"),(0,l.Lk)("th",null,"編輯")])],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.orders,((a,d)=>((0,l.uX)(),(0,l.CE)("tr",{key:d},[(0,l.Lk)("td",null,(0,r.v_)(e.$filters.date(a.create_at)),1),(0,l.Lk)("td",null,(0,r.v_)(a.user.email),1),(0,l.Lk)("td",null,[(0,l.Lk)("ul",i,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(a.products,((e,a)=>((0,l.uX)(),(0,l.CE)("li",{key:a},[(0,l.eW)((0,r.v_)(e.product.title),1),t[0]||(t[0]=(0,l.Lk)("br",null,null,-1)),(0,l.eW)(" 數量: "+(0,r.v_)(e.qty)+(0,r.v_)(e.product.unit),1)])))),128))])]),(0,l.Lk)("td",null,(0,r.v_)(e.$filters.currency(a.total)),1),(0,l.Lk)("td",null,[(0,l.Lk)("div",o,[(0,l.Lk)("label",{for:`paidSwitch${a.id}`,class:"form-check-label"},[(0,l.bo)((0,l.Lk)("input",{type:"checkbox",id:`paidSwitch${a.id}`,"onUpdate:modelValue":e=>a.is_paid=e,onChange:e=>b.updatePaid(a),class:"form-check-input"},null,40,p),[[s.lH,a.is_paid]]),a.is_paid?((0,l.uX)(),(0,l.CE)("span",c,"已付款")):((0,l.uX)(),(0,l.CE)("span",h,"未付款"))],8,u)])]),(0,l.Lk)("td",null,[(0,l.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:(0,s.D$)((e=>b.openModal(a)),["prevent"])},"檢視",8,k),(0,l.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:(0,s.D$)((e=>b.openDelOrderModal(a)),["prevent"])},"刪除",8,L)])])))),128))])])]),(0,l.bF)(_,{pages:g.pagination,onEmitPages:b.getOrders},null,8,["pages","onEmitPages"]),(0,l.bF)(f,{item:g.tempOrder,ref:"delModal",onDelItem:b.delOrder},null,8,["item","onDelItem"]),(0,l.bF)(O,{ref:"orderModal",order:g.tempOrder,onUpdateOrder:b.updatePaid},null,8,["order","onUpdateOrder"])])}var g=a(999);const b={class:"modal",id:"productModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},v={class:"ordermodal modal-dialog modal-xl",role:"document"},_={class:"modal-body"},f={class:"row"},O={class:"userbox col-md-4"},C={key:0},$={class:"orderbox col-md-8"},y={class:"table"},M={key:0},E={key:1},P={class:"table"},x={class:"text-end"},X={class:"modal-footer"};function w(e,t,a,d,n,i){return(0,l.uX)(),(0,l.CE)("div",b,[(0,l.Lk)("div",v,[t[14]||(t[14]=(0,l.Lk)("div",{class:"modal-header border-0"},[(0,l.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},[(0,l.Lk)("span",null,"訂單資料")]),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),(0,l.Lk)("div",_,[(0,l.Lk)("div",f,[(0,l.Lk)("div",O,[t[5]||(t[5]=(0,l.Lk)("h3",null,"訂購人資料",-1)),n.tempOrder.user?((0,l.uX)(),(0,l.CE)("table",C,[(0,l.Lk)("tr",null,[t[1]||(t[1]=(0,l.Lk)("th",{style:{width:"100px"}},"姓名",-1)),(0,l.Lk)("td",null,(0,r.v_)(n.tempOrder.user.name),1)]),(0,l.Lk)("tr",null,[t[2]||(t[2]=(0,l.Lk)("th",null,"Email",-1)),(0,l.Lk)("td",null,(0,r.v_)(n.tempOrder.user.email),1)]),(0,l.Lk)("tr",null,[t[3]||(t[3]=(0,l.Lk)("th",null,"電話",-1)),(0,l.Lk)("td",null,(0,r.v_)(n.tempOrder.user.tel),1)]),(0,l.Lk)("tr",null,[t[4]||(t[4]=(0,l.Lk)("th",null,"地址",-1)),(0,l.Lk)("td",null,(0,r.v_)(n.tempOrder.user.address),1)])])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",$,[t[11]||(t[11]=(0,l.Lk)("h3",null,"訂單內容",-1)),(0,l.Lk)("table",y,[(0,l.Lk)("tbody",null,[(0,l.Lk)("tr",null,[t[6]||(t[6]=(0,l.Lk)("th",{style:{width:"100px"}},"訂單編號",-1)),(0,l.Lk)("td",null,(0,r.v_)(n.tempOrder.id),1)]),(0,l.Lk)("tr",null,[t[7]||(t[7]=(0,l.Lk)("th",null,"下單時間",-1)),(0,l.Lk)("td",null,(0,r.v_)(e.$filters.date(n.tempOrder.create_at)),1)]),(0,l.Lk)("tr",null,[t[8]||(t[8]=(0,l.Lk)("th",null,"付款時間",-1)),(0,l.Lk)("td",null,[n.tempOrder.paid_date?((0,l.uX)(),(0,l.CE)("span",M,(0,r.v_)(e.$filters.date(n.tempOrder.paid_date)),1)):((0,l.uX)(),(0,l.CE)("span",E,"尚未付款"))])]),(0,l.Lk)("tr",null,[t[9]||(t[9]=(0,l.Lk)("th",null,"總金額",-1)),(0,l.Lk)("td",null,(0,r.v_)(e.$filters.currency(n.tempOrder.total)),1)])])]),t[12]||(t[12]=(0,l.Lk)("h3",null,"選購商品",-1)),(0,l.Lk)("table",P,[t[10]||(t[10]=(0,l.Lk)("thead",null,[(0,l.Lk)("tr")],-1)),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.tempOrder.products,(t=>((0,l.uX)(),(0,l.CE)("tr",{key:t.id},[(0,l.Lk)("th",null,(0,r.v_)(t.product.title),1),(0,l.Lk)("td",null,"數量 : "+(0,r.v_)(t.qty),1),(0,l.Lk)("td",x,(0,r.v_)(e.$filters.currency(t.final_total)),1)])))),128))])])])])]),(0,l.Lk)("div",X,[t[13]||(t[13]=(0,l.Lk)("button",{class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)),(0,l.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(0,s.D$)((t=>e.$emit("update-order",n.tempOrder)),["prevent"]))},"確認")])])],512)}var D=a(3286),F={name:"orderModal",props:{order:{type:Object,default(){return{}}}},data(){return{tempOrder:{},isPaid:!1}},mixins:[D.A],watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}}},A=a(1241);const I=(0,A.A)(F,[["render",w]]);var j=I,K=a(1265),S={data(){return{orders:[],pagination:{},tempOrder:{},isNew:!1,isLoading:!1,currentPage:1}},components:{DelModal:g.A,OrderModal:j,Pagination:K.A},inject:["emitter"],methods:{getOrders(e=1){const t=`https://vue3-course-api.hexschool.io/api/hughesh-api/admin/orders?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{this.isLoading=!1,e.data.success&&(this.orders=e.data.orders,this.pagination=e.data.pagination)}))},openModal(e){this.tempOrder={...e};const t=this.$refs.orderModal;t.showModal()},updatePaid(e){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/api/hughesh-api/admin/order/${e.id}`,a={is_paid:e.is_paid};this.$http.put(t,{data:a}).then((e=>{this.$httpMessageState(e,"更新付款狀態"),this.isLoading=!1,this.getOrders(this.currentPage)}))},openDelOrderModal(e){this.tempOrder={...e};const t=this.$refs.delModal;t.showModal()},delOrder(){const e=`https://vue3-course-api.hexschool.io/api/hughesh-api/admin/order/${this.tempOrder.id}`;this.$http.delete(e).then((e=>{this.$httpMessageState(e,"成功刪除訂單");const t=this.$refs.delModal;t.hideModal(),this.emitter.emit("update-orders")}))}},mounted(){this.emitter.on("update-orders",(()=>{this.getOrders()}))},created(){this.getOrders()}};const U=(0,A.A)(S,[["render",m]]);var q=U}}]);
//# sourceMappingURL=751.bc876600.js.map